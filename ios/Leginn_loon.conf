# Loon leginn配置
# Date: 2025-02-17

[General]
# IPv6 支持
ip-mode = dual
# DNS 服务器
dns-server = system
# SNI辅助规则匹配
sni-sniffing = true
# udp相关
disable-stun = false
# 域名拦截行为
dns-reject-mode = LoopbackIP
domain-reject-mode = DNS
# UDP的流量规则匹配到相关节点，该节点不支持UDP或未未开启UDP转发时使用的策略
udp-fallback-mode = REJECT
# 开启局域网访问后的http代理端口
wifi-access-http-port = 7222
# 开启局域网访问后的socks5代理端口
wifi-access-socks5-port = 7221
# 允许 Wi-Fi 网络下其它设备访问
allow-wifi-access = false
# 网络接口
interface-mode = auto
# 测速超时 (s)
test-timeout = 2
# 策略切换时关闭链接
disconnect-on-policy-change = false
# 当节点连续失败多少次后开始切换节点
switch-node-after-failure-times = 3
# 代理测速 URL
internet-test-url = http://connectivitycheck.platform.hicloud.com/generate_204
proxy-test-url = http://www.gstatic.com/generate_204
# 解析器
resource-parser = https://raw.githubusercontent.com/sub-store-org/Sub-Store/release/sub-store-parser.loon.min.js
# geoip和asn
geoip-url = https://geodata.kelee.one/Country-Masaiki.mmdb
ipasn-url = https://geodata.kelee.one/GeoLite2-ASN-P3TERX.mmdb
# > 跳过代理
# 跳过某个域名或者 IP 段，这些目标主机将不会由 Loon Proxy 处理。
skip-proxy = 192.168.0.0/16,10.0.0.0/8,172.16.0.0/12,localhost,*.local,e.crashlynatics.com
# > Always Real IP Hosts
# DNS 数据包将被转发到上游 DNS 服务器。
bypass-tun = 10.0.0.0/8,100.64.0.0/10,127.0.0.0/8,169.254.0.0/16,172.16.0.0/12,192.0.0.0/24,192.0.2.0/24,192.88.99.0/24,192.168.0.0/16,198.51.100.0/24,203.0.113.0/24,224.0.0.0/4,255.255.255.255/32

[Proxy]

[Remote Proxy]

[Remote Filter]
游戏节点 = NameRegex, FilterKey = "^(?=.*((?i)游戏|🎮|(\b(GAME)(\d+)?\b)))(?!.*((?i)回国|校园)).*$"
全球节点 = NameRegex, FilterKey = "^(?=.*(.))(?!.*((?i)群|邀请|返利|循环|官网|客服|网站|网址|获取|订阅|流量|到期|机场|下次|版本|官址|备用|过期|已用|联系|邮箱|工单|贩卖|通知|倒卖|防止|国内|地址|频道|无法|说明|使用|提示|特别|访问|支持|(\b(USE|USED|TOTAL|EXPIRE|EMAIL|Panel)\b|(\d{4}-\d{2}-\d{2}|\dG)))).*$"
香港节点 = NameRegex, FilterKey = "^(?=.*((?i)🇭🇰|香港|(\b(HK|Hong)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"
台湾节点 = NameRegex, FilterKey = "^(?=.*((?i)🇹🇼|台湾|(\b(TW|Tai|Taiwan)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"
日本节点 = NameRegex, FilterKey = "^(?=.*((?i)🇯🇵|日本|川日|东京|大阪|泉日|埼玉|(\b(JP|Japan)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"
韩国节点 = NameRegex, FilterKey = "^(?=.*((?i)🇰🇷|韩国|韓|首尔|(\b(KR|Korea)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"
新国节点 = NameRegex, FilterKey = "^(?=.*((?i)🇸🇬|新加坡|狮|(\b(SG|Singapore)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"
美国节点 = NameRegex, FilterKey = "^(?=.*((?i)🇺🇸|美国|波特兰|达拉斯|俄勒冈|凤凰城|费利蒙|硅谷|拉斯维加斯|洛杉矶|圣何塞|圣克拉拉|西雅图|芝加哥|(\b(US|United States)(\d+)?\b)))(?!.*((?i)回国|校园|游戏|🎮|(\b(GAME)(\d+)?\b))).*$"

[Proxy Group]
# 手动策略组
手动选择 = select,DIRECT,全球节点,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Static.png
节点选择 = select,DIRECT,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,手动选择,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Global.png
# --------------------------------
# 国外媒体
国外媒体 = select,节点选择,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/LineTV.png
# --------------------------------
# 软件网站
Google = select,节点选择,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Google.png
Github = select,节点选择,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/github.png
Telegram = select,节点选择,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/Telegram.png
AI = select,节点选择,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/OpenAI.png
# --------------------------------
# 延迟最低策略组
香港节点最速 = url-test,香港节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/HK.png
台湾节点最速 = url-test,台湾节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/TW.png
日本节点最速 = url-test,日本节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/JP.png
韩国节点最速 = url-test,韩国节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/KR.png
新国节点最速 = url-test,新国节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/SG.png
美国节点最速 = url-test,美国节点,interval = 60,tolerance = 50,img-url = https://raw.githubusercontent.com/Orz-3/mini/master/Color/US.png
# --------------------------------

# 兜底策略后备
兜底后备 = select,香港节点最速,台湾节点最速,日本节点最速,韩国节点最速,新国节点最速,美国节点最速,img-url = https://github.com/shindgewongxj/WHATSINStash/raw/main/icon/fallback.png

[Rule]
# Local Rule
# Type:DOMAIN-SUFFIX,DOMAIN,DOMAIN-KEYWORD,USER-AGENT,URL-REGEX,IP-CIDR,IP-CIDR6,IP-ASN
# Strategy:DIRECT,Proxy,REJECT
# Options:no-resolve(no-resolve(only for cidr))
# IP-CIDR,192.168.0.0/16,DIRECT
# IP-CIDR,10.0.0.0/8,DIRECT
# IP-CIDR,172.16.0.0/12,DIRECT
# IP-CIDR,127.0.0.0/8,DIRECT
GEOIP,CN,DIRECT
FINAL,兜底后备

[Remote Rule]
https://rule.kelee.one/Loon/Telegram.list, policy=Telegram, tag=Telegram, enabled=true
https://kelee.one/Tool/Loon/Rule/TikTok.list, policy=国外媒体, tag=TikTok, enabled=true
https://kelee.one/Tool/Loon/Rule/AI.list, policy=AI, tag=AI, enabled=true
https://kelee.one/Tool/Loon/Rule/AppleID.list, policy=DIRECT, tag=Apple Account, enabled=true
https://kelee.one/Tool/Loon/Rule/AppStore.list, policy=DIRECT, tag=App Store, enabled=false
https://rule.kelee.one/Loon/GitHub.list, policy=Github, tag=GitHub, enabled=true
https://rule.kelee.one/Loon/Netflix.list, policy=国外媒体, tag=Netflix, enabled=true
https://rule.kelee.one/Loon/YouTube.list, policy=国外媒体, tag=Youtube, enabled=true
https://rule.kelee.one/Loon/Disney.list, policy=国外媒体, tag=Disney, enabled=true
https://rule.kelee.one/Loon/Twitter.list, policy=国外媒体, tag=Twitter, enabled=true
https://rule.kelee.one/Loon/Facebook.list, policy=国外媒体, tag=Facebook, enabled=true
https://rule.kelee.one/Loon/Instagram.list, policy=国外媒体, tag=Instagram, enabled=true
https://rule.kelee.one/Loon/Spotify.list, policy=国外媒体, tag=Spotify, enabled=true
https://rule.kelee.one/Loon/Google.list, policy=Google, tag=Google, enabled=true
https://rule.kelee.one/Loon/OneDrive.list, policy=DIRECT, tag=OneDrive, enabled=true
https://kelee.one/Tool/Loon/Rule/LAN_SPLITTER, policy=DIRECT, tag=LAN, enabled=true
https://kelee.one/Tool/Loon/Rule/REGION_SPLITTER, policy=DIRECT, tag=CN REGION, enabled=true

[Host]

[Rewrite]

[Script]

[Plugin]
https://kelee.one/Tool/Loon/Plugin/LoonGallery.plugin, policy=兜底后备, enabled=true
https://kelee.one/Tool/Loon/Plugin/Block_HTTPDNS.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/BlockAdvertisers.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/Remove_ads_by_keli.plugin, enabled=true
https://github.com/NSRingo/WeatherKit/releases/latest/download/iRingo.WeatherKit.plugin, enabled=true
https://github.com/NSRingo/GeoServices/releases/latest/download/iRingo.Location.plugin, enabled=true
https://github.com/NSRingo/GeoServices/releases/latest/download/iRingo.Maps.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/QuickSearch.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/Prevent_DNS_Leaks.plugin, policy=兜底后备, enabled=true
https://kelee.one/Tool/Loon/Plugin/DragonRead_remove_ads.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/Bilibili_remove_ads.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/Node_detection_tool.plugin, enabled=true
https://kelee.one/Tool/Loon/Plugin/TestFlightRegionUnlock.plugin, policy=DIRECT, enabled=true
https://kelee.one/Tool/Loon/Plugin/BoxJs.plugin, policy=兜底后备, enabled=true
https://kelee.one/Tool/Loon/Plugin/Sub-Store.plugin, policy=兜底后备, enabled=true
https://kelee.one/Tool/Loon/Plugin/Script-Hub.plugin, policy=兜底后备, enabled=true


[Mitm]
ca-passphrase =
hostname =
ca-p12=
ca-passphrase=
skip-server-cert-verify = false
